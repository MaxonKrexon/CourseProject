@using FreshSight.Controllers
@{
    ViewData["Title"] = "My blog";
    var ProfilePicLink = Model["PicLink"][0][0];
}
<div class="border-bottom">
    <div class="d-inline-flex">
        <img src="@ProfilePicLink" alt="Profile picture" style="border-radius: 75px; height: 150px; width: 150px;">
    </div>
    <div class="d-inline-flex">
        <h3>@User.Identity?.Name</h3> 
    </div>
    <div class="d-inline-flex">
    @if(Model.ContainsKey("Age"))
    {
     <h4>Age: @Model["Age"][0][0]</h4>
    }
    </div>
</div>
<br />
<div class = "row">
    <div class = "col-md-4 border">
        <h3>Tools</h3>
        <ul class="nav nav-pills flex-column">
            <li class="nav-item"><a class="btn btn-info" asp-area="" asp-controller="Post" asp-action="Index" role="button">New post</a></li>
        </ul>
    </div>
    <div id = "posts" class = "col-md-6 col-md-offset-2 border">
        <h3>Your posts</h3>
        @if(Model.ContainsKey("Posts")){
        foreach(var post in Model["Posts"]){
            String link = $"https://freshsightcloud.blob.core.windows.net/posts/{post[0]}_thumb";    
            <div class ="row border" style="offset: auto;" id = "@post[0]">
                <div class="col" id="@post[0]">
                    <img src="@link" id="@post[0]" style="offset: auto; border-radius: 35px;height: 150px; width: 300px;">
                </div>
                <div class="col" id="@post[0]" style = "offset: auto;">
                    Category: @post[1] <h3>@post[2]<h3>
                </div>
            </div>
        }
        }
    </div>
</div>

@section Scripts{
    <script>
        $("#posts").click(function(event){
            var data = new FormData();
            data.append("id",event.target.id);

            $.ajax({
                type: "POST",
                url: "/Blog/ViewPost",
                contentType: false,
                processData: false,
                data: data,
                success: function () {
                    //$("#fileBasket").html("Success!");
                },
                error: function () {
                    $("#posts").html("Error occured");
                },
            });
        });
    </script>
}